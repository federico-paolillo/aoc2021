import unittest

from aoc2021.day_two import part_one, part_two

_PUZZLE_COMMANDS = [
    "forward 1",
    "down 3",
    "down 2",
    "up 1",
    "down 7",
    "down 8",
    "forward 6",
    "forward 1",
    "forward 1",
    "down 6",
    "up 3",
    "down 7",
    "down 1",
    "down 6",
    "forward 6",
    "down 6",
    "forward 3",
    "up 7",
    "forward 5",
    "down 4",
    "forward 6",
    "forward 1",
    "forward 6",
    "forward 9",
    "forward 3",
    "up 1",
    "forward 7",
    "down 9",
    "forward 2",
    "up 9",
    "down 5",
    "down 3",
    "up 1",
    "down 6",
    "down 7",
    "down 8",
    "down 7",
    "forward 7",
    "forward 3",
    "down 5",
    "down 2",
    "forward 4",
    "forward 7",
    "down 8",
    "down 4",
    "down 5",
    "down 1",
    "forward 4",
    "up 6",
    "forward 6",
    "forward 4",
    "forward 5",
    "up 3",
    "up 6",
    "down 4",
    "down 8",
    "forward 4",
    "forward 5",
    "down 3",
    "forward 1",
    "down 5",
    "down 5",
    "forward 8",
    "forward 9",
    "forward 1",
    "forward 8",
    "forward 5",
    "forward 6",
    "up 8",
    "down 3",
    "forward 8",
    "up 2",
    "down 3",
    "down 9",
    "up 9",
    "forward 5",
    "down 2",
    "forward 7",
    "forward 5",
    "forward 5",
    "down 2",
    "down 3",
    "forward 7",
    "forward 9",
    "down 9",
    "forward 3",
    "forward 3",
    "down 3",
    "forward 3",
    "up 6",
    "down 4",
    "forward 3",
    "forward 3",
    "forward 7",
    "down 4",
    "forward 8",
    "up 8",
    "down 3",
    "down 2",
    "forward 2",
    "down 6",
    "down 6",
    "up 7",
    "up 9",
    "down 4",
    "up 7",
    "up 8",
    "down 6",
    "down 1",
    "forward 6",
    "forward 9",
    "forward 1",
    "forward 8",
    "down 4",
    "up 3",
    "forward 6",
    "down 5",
    "forward 7",
    "forward 5",
    "down 2",
    "forward 7",
    "down 6",
    "forward 7",
    "up 2",
    "up 5",
    "forward 3",
    "down 6",
    "down 9",
    "down 9",
    "forward 9",
    "up 7",
    "down 6",
    "down 4",
    "down 8",
    "forward 6",
    "up 6",
    "down 2",
    "forward 5",
    "up 7",
    "forward 5",
    "down 1",
    "up 8",
    "forward 2",
    "forward 4",
    "down 5",
    "down 8",
    "up 7",
    "up 5",
    "down 2",
    "forward 8",
    "forward 4",
    "up 6",
    "forward 8",
    "down 3",
    "down 2",
    "down 2",
    "forward 4",
    "forward 2",
    "forward 9",
    "up 3",
    "up 7",
    "up 3",
    "up 5",
    "forward 5",
    "up 8",
    "forward 3",
    "forward 1",
    "down 3",
    "down 8",
    "forward 6",
    "forward 5",
    "up 5",
    "down 9",
    "down 1",
    "down 9",
    "forward 9",
    "up 3",
    "forward 7",
    "forward 6",
    "forward 1",
    "up 3",
    "forward 9",
    "forward 7",
    "down 9",
    "up 6",
    "forward 2",
    "up 9",
    "forward 6",
    "forward 4",
    "up 3",
    "forward 5",
    "down 4",
    "up 8",
    "up 4",
    "up 9",
    "down 1",
    "down 7",
    "forward 7",
    "forward 2",
    "down 9",
    "forward 7",
    "forward 2",
    "down 6",
    "down 9",
    "up 6",
    "down 7",
    "down 2",
    "down 7",
    "down 6",
    "down 4",
    "down 4",
    "forward 6",
    "forward 9",
    "forward 4",
    "down 7",
    "down 5",
    "up 6",
    "down 7",
    "forward 2",
    "down 3",
    "down 1",
    "forward 1",
    "forward 5",
    "down 4",
    "down 4",
    "down 1",
    "down 9",
    "forward 6",
    "down 3",
    "forward 5",
    "up 7",
    "forward 9",
    "down 8",
    "down 3",
    "up 2",
    "up 2",
    "forward 4",
    "down 7",
    "forward 2",
    "forward 5",
    "forward 4",
    "forward 3",
    "down 8",
    "down 6",
    "forward 9",
    "down 1",
    "forward 1",
    "down 1",
    "up 8",
    "down 2",
    "forward 2",
    "up 5",
    "down 7",
    "forward 8",
    "down 7",
    "down 4",
    "forward 2",
    "forward 6",
    "up 2",
    "forward 8",
    "forward 2",
    "forward 1",
    "up 5",
    "down 4",
    "down 8",
    "forward 4",
    "down 8",
    "up 8",
    "forward 3",
    "down 5",
    "forward 2",
    "forward 1",
    "up 3",
    "forward 9",
    "up 5",
    "forward 5",
    "forward 5",
    "up 8",
    "down 6",
    "forward 3",
    "down 4",
    "up 5",
    "forward 3",
    "up 6",
    "forward 6",
    "forward 9",
    "down 7",
    "down 7",
    "down 8",
    "down 4",
    "forward 4",
    "forward 3",
    "forward 3",
    "forward 5",
    "down 3",
    "forward 8",
    "up 5",
    "forward 1",
    "up 7",
    "down 5",
    "forward 7",
    "forward 3",
    "down 3",
    "forward 2",
    "forward 1",
    "forward 4",
    "up 2",
    "down 8",
    "forward 9",
    "forward 9",
    "down 6",
    "down 1",
    "down 5",
    "forward 4",
    "down 2",
    "forward 1",
    "up 7",
    "down 9",
    "forward 3",
    "down 5",
    "down 5",
    "up 6",
    "down 6",
    "forward 8",
    "down 1",
    "up 3",
    "down 2",
    "up 1",
    "forward 5",
    "down 4",
    "down 6",
    "forward 8",
    "down 4",
    "down 5",
    "down 2",
    "forward 5",
    "forward 8",
    "down 8",
    "up 4",
    "forward 2",
    "up 2",
    "down 9",
    "forward 6",
    "forward 1",
    "forward 5",
    "up 2",
    "down 1",
    "up 7",
    "up 3",
    "forward 3",
    "down 7",
    "forward 2",
    "forward 4",
    "up 7",
    "forward 4",
    "forward 6",
    "up 2",
    "forward 4",
    "forward 2",
    "down 6",
    "down 5",
    "down 5",
    "down 6",
    "forward 9",
    "up 4",
    "down 4",
    "down 7",
    "up 6",
    "up 9",
    "up 4",
    "down 4",
    "up 7",
    "down 9",
    "down 9",
    "forward 3",
    "down 7",
    "down 7",
    "down 7",
    "down 2",
    "up 2",
    "up 1",
    "up 6",
    "down 8",
    "up 7",
    "down 4",
    "forward 8",
    "down 7",
    "up 1",
    "down 5",
    "down 3",
    "forward 6",
    "up 1",
    "down 5",
    "forward 3",
    "forward 6",
    "forward 7",
    "forward 2",
    "down 3",
    "forward 1",
    "up 9",
    "down 5",
    "up 2",
    "up 9",
    "up 2",
    "up 2",
    "forward 1",
    "down 2",
    "forward 1",
    "down 7",
    "forward 1",
    "forward 8",
    "down 9",
    "down 1",
    "forward 9",
    "forward 7",
    "forward 7",
    "down 5",
    "down 5",
    "down 3",
    "forward 6",
    "down 7",
    "down 4",
    "forward 2",
    "up 6",
    "down 3",
    "up 4",
    "up 7",
    "forward 2",
    "forward 8",
    "forward 4",
    "down 7",
    "down 9",
    "up 1",
    "down 2",
    "up 8",
    "down 2",
    "up 6",
    "forward 6",
    "up 5",
    "down 2",
    "forward 5",
    "down 4",
    "forward 7",
    "down 3",
    "down 5",
    "forward 1",
    "down 7",
    "forward 1",
    "up 1",
    "forward 4",
    "up 4",
    "forward 4",
    "forward 5",
    "forward 7",
    "down 7",
    "down 2",
    "up 4",
    "down 2",
    "down 3",
    "forward 3",
    "forward 2",
    "forward 5",
    "forward 2",
    "up 8",
    "forward 3",
    "down 7",
    "down 9",
    "forward 3",
    "forward 6",
    "down 7",
    "down 5",
    "down 3",
    "up 3",
    "forward 5",
    "forward 2",
    "down 1",
    "up 1",
    "up 8",
    "down 6",
    "down 4",
    "down 1",
    "forward 1",
    "down 7",
    "up 8",
    "forward 2",
    "forward 8",
    "forward 8",
    "forward 7",
    "down 1",
    "forward 8",
    "down 8",
    "forward 4",
    "down 3",
    "up 9",
    "down 8",
    "forward 9",
    "down 7",
    "up 2",
    "forward 9",
    "down 4",
    "up 3",
    "up 4",
    "up 4",
    "forward 5",
    "up 2",
    "forward 3",
    "down 5",
    "forward 5",
    "down 5",
    "up 8",
    "down 4",
    "forward 6",
    "down 6",
    "forward 7",
    "forward 2",
    "down 2",
    "up 7",
    "down 5",
    "down 9",
    "down 8",
    "down 4",
    "up 3",
    "forward 4",
    "down 8",
    "down 8",
    "down 9",
    "down 7",
    "forward 2",
    "forward 8",
    "up 5",
    "forward 8",
    "down 9",
    "forward 6",
    "up 1",
    "down 6",
    "forward 1",
    "up 4",
    "down 3",
    "forward 3",
    "forward 2",
    "down 6",
    "forward 7",
    "up 6",
    "up 9",
    "down 1",
    "forward 3",
    "forward 4",
    "forward 2",
    "up 8",
    "forward 9",
    "up 7",
    "down 2",
    "forward 2",
    "up 7",
    "down 2",
    "up 6",
    "down 2",
    "forward 9",
    "forward 3",
    "down 6",
    "down 5",
    "down 3",
    "forward 9",
    "down 8",
    "down 8",
    "down 2",
    "down 7",
    "up 3",
    "forward 1",
    "down 7",
    "up 8",
    "up 8",
    "forward 5",
    "forward 5",
    "forward 1",
    "down 8",
    "down 6",
    "forward 2",
    "up 3",
    "forward 1",
    "forward 7",
    "forward 4",
    "forward 5",
    "forward 9",
    "forward 7",
    "forward 6",
    "forward 3",
    "forward 4",
    "down 8",
    "down 1",
    "forward 6",
    "forward 9",
    "forward 6",
    "forward 9",
    "forward 6",
    "up 3",
    "down 8",
    "forward 4",
    "forward 1",
    "down 4",
    "forward 9",
    "down 8",
    "down 3",
    "up 2",
    "forward 5",
    "forward 2",
    "forward 5",
    "down 6",
    "down 3",
    "up 1",
    "down 9",
    "up 5",
    "forward 6",
    "down 7",
    "forward 1",
    "forward 9",
    "down 2",
    "down 5",
    "forward 3",
    "forward 6",
    "down 4",
    "down 5",
    "up 4",
    "forward 7",
    "forward 5",
    "down 8",
    "forward 6",
    "down 5",
    "forward 2",
    "down 7",
    "forward 4",
    "forward 8",
    "down 8",
    "forward 2",
    "forward 8",
    "down 5",
    "forward 7",
    "down 8",
    "down 1",
    "forward 8",
    "down 4",
    "up 4",
    "down 7",
    "down 6",
    "up 5",
    "forward 4",
    "forward 1",
    "forward 4",
    "down 5",
    "forward 5",
    "forward 9",
    "down 1",
    "forward 3",
    "up 7",
    "down 1",
    "down 7",
    "forward 2",
    "down 5",
    "down 6",
    "forward 5",
    "up 2",
    "down 9",
    "forward 1",
    "up 5",
    "forward 6",
    "forward 9",
    "forward 4",
    "up 4",
    "down 6",
    "up 9",
    "up 5",
    "down 2",
    "up 9",
    "down 2",
    "down 4",
    "down 8",
    "down 2",
    "forward 2",
    "forward 2",
    "down 9",
    "up 5",
    "forward 2",
    "forward 8",
    "down 2",
    "down 2",
    "down 9",
    "down 3",
    "down 9",
    "up 9",
    "up 3",
    "down 1",
    "down 9",
    "down 2",
    "forward 7",
    "down 2",
    "up 3",
    "down 9",
    "up 2",
    "up 4",
    "forward 5",
    "forward 7",
    "down 7",
    "up 7",
    "up 5",
    "down 8",
    "up 2",
    "forward 2",
    "down 3",
    "down 5",
    "forward 2",
    "forward 3",
    "forward 3",
    "down 1",
    "down 1",
    "forward 9",
    "down 5",
    "down 7",
    "forward 7",
    "forward 5",
    "up 9",
    "forward 3",
    "up 4",
    "forward 1",
    "forward 3",
    "down 4",
    "forward 9",
    "down 5",
    "down 3",
    "down 5",
    "forward 6",
    "down 6",
    "forward 2",
    "up 4",
    "down 4",
    "forward 2",
    "down 8",
    "up 9",
    "forward 9",
    "forward 4",
    "down 8",
    "forward 2",
    "forward 5",
    "forward 1",
    "forward 5",
    "up 1",
    "forward 7",
    "forward 9",
    "down 5",
    "forward 6",
    "down 1",
    "forward 6",
    "down 2",
    "forward 9",
    "down 1",
    "forward 1",
    "down 4",
    "down 6",
    "down 2",
    "up 7",
    "up 5",
    "forward 8",
    "forward 1",
    "down 8",
    "forward 1",
    "forward 2",
    "down 8",
    "forward 7",
    "down 5",
    "forward 1",
    "down 2",
    "up 7",
    "forward 7",
    "down 4",
    "down 8",
    "up 6",
    "up 4",
    "forward 7",
    "down 3",
    "up 5",
    "down 5",
    "forward 7",
    "up 7",
    "down 6",
    "forward 8",
    "down 7",
    "down 2",
    "up 3",
    "down 9",
    "down 7",
    "down 8",
    "forward 4",
    "forward 3",
    "forward 9",
    "forward 6",
    "up 7",
    "forward 5",
    "down 4",
    "down 5",
    "forward 6",
    "up 9",
    "down 6",
    "down 7",
    "down 8",
    "down 9",
    "down 4",
    "up 5",
    "down 4",
    "forward 5",
    "forward 3",
    "down 3",
    "down 7",
    "up 8",
    "forward 5",
    "down 8",
    "down 1",
    "down 6",
    "down 9",
    "up 4",
    "up 1",
    "down 8",
    "down 3",
    "down 8",
    "up 4",
    "down 7",
    "down 6",
    "forward 7",
    "up 9",
    "down 4",
    "down 1",
    "down 6",
    "down 2",
    "forward 7",
    "down 2",
    "down 7",
    "forward 3",
    "forward 6",
    "up 2",
    "down 4",
    "up 1",
    "forward 4",
    "up 2",
    "down 4",
    "up 3",
    "down 8",
    "up 9",
    "forward 8",
    "down 5",
    "down 4",
    "forward 8",
    "down 1",
    "down 8",
    "forward 3",
    "down 4",
    "forward 5",
    "down 5",
    "up 9",
    "forward 1",
    "down 9",
    "down 1",
    "forward 4",
    "forward 9",
    "up 1",
    "forward 4",
    "forward 2",
    "down 9",
    "down 1",
    "forward 1",
    "down 2",
    "forward 2",
    "down 5",
    "up 4",
    "up 7",
    "down 8",
    "forward 3",
    "up 1",
    "down 4",
    "forward 5",
    "up 2",
    "forward 4",
    "forward 2",
    "down 1",
    "forward 4",
    "forward 1",
    "up 5",
    "forward 8",
    "forward 4",
    "forward 1",
    "down 6",
    "down 7",
    "up 4",
    "forward 9",
    "up 6",
    "forward 9",
    "forward 3",
    "forward 2",
    "down 2",
    "forward 7",
    "up 7",
    "forward 7",
    "down 4",
    "down 6",
    "forward 8",
    "up 8",
    "forward 1",
    "forward 3",
    "forward 3",
    "up 8",
    "down 1",
    "up 9",
    "forward 1",
    "up 1",
    "down 7",
    "forward 7",
    "up 5",
    "forward 5",
    "up 9",
    "up 3",
    "forward 2",
    "forward 6",
    "up 1",
    "forward 5",
    "up 1",
    "down 3",
    "down 5",
    "forward 8",
    "up 5",
    "forward 1",
    "down 8",
    "forward 4",
    "down 3",
    "down 1",
    "down 7",
    "forward 7",
    "forward 3",
    "down 4",
    "forward 9",
    "up 5",
    "down 2",
    "forward 4",
    "up 7",
    "up 5",
    "forward 3",
    "down 7",
    "forward 8",
    "up 4",
    "up 2",
    "forward 2",
    "down 9",
    "forward 4",
    "down 5",
    "forward 2",
    "down 9",
    "down 5",
    "up 7",
    "forward 3",
    "down 8",
    "forward 7",
    "forward 9",
    "down 5",
    "forward 2",
    "forward 9",
    "forward 5",
    "down 5",
    "up 4",
    "down 6",
    "down 6",
    "forward 8",
    "forward 5",
    "forward 4",
    "down 5",
    "forward 2",
    "down 8",
    "forward 9",
    "down 1",
    "down 8",
    "down 7",
    "up 9",
    "down 7",
    "down 1",
    "forward 7",
    "forward 9",
    "forward 8",
    "up 2",
    "forward 6",
    "down 3",
    "down 6",
    "up 4",
    "forward 4",
    "forward 5",
    "down 9",
    "down 5",
    "forward 1",
    "down 2",
    "forward 1",
    "down 1",
    "up 1",
    "up 7",
    "up 5",
    "forward 6",
    "forward 3",
]


class DayTwoTestCase(unittest.TestCase):
    def test_day_two_part_one_solves_example_commands_correctly(self):
        commands = [
            "forward 5",
            "down 5",
            "forward 8",
            "up 3",
            "down 8",
            "forward 2"
        ]

        hposition, depth = part_one(0, 0, commands)

        self.assertEqual(hposition, 15)
        self.assertEqual(depth, 10)

    def test_day_two_part_one_solves_puzzle_commands_correctly(self):
        hposition, depth = part_one(0, 0, _PUZZLE_COMMANDS)

        self.assertEqual(hposition * depth, 1840243)

    def test_day_two_part_one_ignores_wrong_commands(self):
        commands = [
            "forward 5",
            "down 5",
            "forward 8",
            "up 3",
            "down 8",
            "sideways 18",
            "forward forward"
            "",
            None,
            "forward 2"
        ]

        hposition, depth = part_one(0, 0, commands)

        self.assertEqual(hposition, 15)
        self.assertEqual(depth, 10)

    def test_day_two_part_one_returns_0_0_for_no_input(self):
        commands = [
        ]

        hposition, depth = part_one(0, 0, commands)

        self.assertEqual(hposition, 0)
        self.assertEqual(depth, 0)

    def test_day_two_part_two_solves_example_commands_correctly(self):
        commands = [
            "forward 5",
            "down 5",
            "forward 8",
            "up 3",
            "down 8",
            "forward 2"
        ]

        hposition, depth = part_two(0, 0, commands)

        self.assertEqual(hposition, 15)
        self.assertEqual(depth, 60)

    def test_day_two_part_two_solves_puzzle_commands_correctly(self):
        hposition, depth = part_two(0, 0, _PUZZLE_COMMANDS)

        self.assertEqual(hposition * depth, 1727785422)

    def test_day_two_part_two_ignores_wrong_commands(self):
        commands = [
            "forward 5",
            "down 5",
            "forward 8",
            "up 3",
            "down 8",
            "sideways 18",
            "forward forward"
            "",
            None,
            "forward 2"
        ]

        hposition, depth = part_two(0, 0, commands)

        self.assertEqual(hposition, 15)
        self.assertEqual(depth, 60)

    def test_day_two_part_two_returns_0_0_for_no_input(self):
        commands = [
        ]

        hposition, depth = part_two(0, 0, commands)

        self.assertEqual(hposition, 0)
        self.assertEqual(depth, 0)
